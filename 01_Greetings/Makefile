MODULE_DIR = mods
JAVA_PACKAGE_NAME = com.greetings
JAVA_PACKAGE_NAME_DIR = com/greetings
MODULE_ROOT_PATH = $(MODULE_DIR)/$(JAVA_PACKAGE_NAME)
SRC_ROOT_PATH = src/$(JAVA_PACKAGE_NAME)/
SRC_FILES = $(SRC_ROOT_PATH)/module-info.java $(SRC_ROOT_PATH)/$(JAVA_PACKAGE_NAME_DIR)/Main.java
MODULE_INFO_CLASS = $(MODULE_ROOT_PATH)/module-info.class
MODULE_MAIN = $(MODULE_ROOT_PATH)/$(JAVA_PACAKGE_NAME_DIR)/Main.class
TARGET = $(MODULE_INFO_CLASS) $(MODULE_MAIN)

all: $(TARGET) $(MODULE_DIR)
	java --module-path $(MODULE_DIR) -m $(JAVA_PACKAGE_NAME)/$(JAVA_PACKAGE_NAME).Main

$(TARGET): $(SRC_FILES) $(MODULE_PATH)
	javac -d $(MODULE_DIR)/$(JAVA_PACKAGE_NAME) $(MODULE_PATH) $(SRC_FILES)

$(MODULE_PATH):
	mkdir -p $(MODULE_PATH)

$(MODULE_DIR):
	mkdir -p $(MODULE_DIR)

clean:
	rm -rf $(MODULE_DIR)

.PHONY: all clean
